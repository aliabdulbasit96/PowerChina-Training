<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Power China E&S Training Portal – Suez 1.1 GW Wind Farm</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <img src="powerchina_logo.png" class="logo" alt="Power China" />
      <div class="title">
        <h1>Power China Environmental Training Portal</h1>
        <p>Suez 1.1 GW Wind Farm Project</p>
      </div>
      <img src="project_logo.png" class="logo" alt="Suez 1.1 GW Wind Farm" />
    </div>
    <nav class="nav">
      <div class="nav-inner">
        <button id="tab-portal" class="tab-btn active">Training Portal</button>
        <button id="tab-dashboard" class="tab-btn">Dashboard</button>
      </div>
    </nav>
  </header>

  <main class="container">
    <!-- Training Portal -->
    <section id="section-portal" class="grid">
      <div class="card">
        <div class="grid grid-2">
          <input name="name" class="input" placeholder="Full Name" form="trainingForm" required />
          <input name="company" class="input" placeholder="Company Name" form="trainingForm" required />
          <input name="jobTitle" class="input" placeholder="Job Title" form="trainingForm" required />
          <input type="email" name="email" class="input" placeholder="Email" form="trainingForm" required />

          <select name="language" id="language" class="input" form="trainingForm" required>
            <option value="">Select Language</option>
            <option value="English">English</option>
            <option value="العربية">العربية</option>
            <option value="中文">中文</option>
          </select>

          <select name="topic" id="topic" class="input" form="trainingForm" required>
            <option value="">Select Training Topic</option>
          </select>
        </div>

        <div class="actions" style="margin-top:12px">
          <form id="trainingForm"></form>
          <button type="submit" class="btn btn-primary" form="trainingForm">Save Registration</button>
          <div class="start-tile" id="startTrainingBtn">▶ Start Training</div>
          <span id="formStatus"></span>
        </div>
      </div>
    </section>

    <!-- Dashboard -->
    <section id="section-dashboard" class="hidden grid">
      <div class="grid grid-3">
        <div class="card kpi"><div class="label">Total Registrations</div><div id="kpiTotal" class="value">0</div></div>
        <div class="card kpi"><div class="label">Today's Registrations</div><div id="kpiToday" class="value">0</div></div>
        <div class="card kpi"><div class="label">Companies Count</div><div id="kpiCompanies" class="value">0</div></div>
      </div>

      <div class="grid grid-2">
        <div class="card"><canvas id="chartLanguages"></canvas></div>
        <div class="card"><canvas id="chartTopics"></canvas></div>
      </div>
      <div class="card"><canvas id="chartMonthly"></canvas></div>

      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <h3 style="margin:0">Recent Registrations</h3>
          <div style="display:flex;gap:8px">
            <a class="btn btn-success" href="https://script.google.com/macros/s/AKfycbx5KCwFwS758NABsn-Pos2SP-Pu6uijAMWgvFtXRYx6r3c3GUYWgYYUVraDLtIxSEMf/exec?download=excel" target="_blank">Download Excel</a>
            <button id="btnExport" class="btn btn-danger" type="button">Export Local CSV</button>
          </div>
        </div>
        <div style="overflow:auto;margin-top:10px">
          <table class="table">
            <thead><tr><th>#</th><th>Name</th><th>Company</th><th>Job Title</th><th>Language</th><th>Topic</th></tr></thead>
            <tbody id="tableBody"><tr><td colspan="6">No data</td></tr></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer>© 2025 Power China – Suez 1.1 GW Wind Farm Project</footer>

  <script src="app.js"></script>
</body>
</html>
